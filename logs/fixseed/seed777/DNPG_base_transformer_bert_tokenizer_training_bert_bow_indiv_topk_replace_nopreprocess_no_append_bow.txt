Config: {'save_model_path': '../models/DNPG_base_transformer_bert_tokenizer_bert_bow_indivtopk_replace_nopreprocess_no_append_bow.pth', 'log_file': '../logs/DNPG_base_transformer_bert_tokenizer_training_bert_bow_indiv_topk_replace_nopreprocess_no_append_bow.txt', 'test_output_file': '../outputs/test_DNPG_transformer_bert_tokenizer_bow_indivtopk_replace_out_nopreprocess_no_append_bow.txt', 'val_output_file': '../outputs/val_DNPG_transformer_bert_tokenizer_bow_indivtopk_replace_out_nopreprocess_no_append_bow.txt', 'dataset': 'quora_bert_mask_predict_dataset', 'num_epochs': 50, 'batch_size': 100, 'd_model': 450, 'd_inner_hid': 512, 'd_k': 50, 'd_v': 50, 'n_head': 9, 'n_layers': 3, 'n_warmup_steps': 12000, 'dropout': 0.1, 'embs_share_weight': True, 'proj_share_weight': True, 'label_smoothing': False, 'train_size': 100000, 'val_size': 4000, 'test_size': 20000, 'is_bow': True, 'bow_strategy': 'indiv_topk', 'indiv_topk': 10, 'topk': 25, 'lr': '1e-3', 'only_bow': False, 'replace_predict': True, 'append_bow': False}
- (Training)   ppl:  20153.00406, accuracy: 7.513 %, elapse: 5943.425 sec
- (Validation) ppl:  9759.24027, accuracy: 7.688 %, elapse: 235.789 sec
model saved in Epoch 1
- (Training)   ppl:  2748.56753, accuracy: 11.373 %, elapse: 5925.936 sec
- (Validation) ppl:  764.26990, accuracy: 15.172 %, elapse: 231.072 sec
model saved in Epoch 2
- (Training)   ppl:  439.02050, accuracy: 16.167 %, elapse: 5937.825 sec
- (Validation) ppl:  245.58530, accuracy: 21.809 %, elapse: 236.097 sec
model saved in Epoch 3
- (Training)   ppl:  181.97303, accuracy: 24.526 %, elapse: 5967.114 sec
- (Validation) ppl:  130.16697, accuracy: 27.673 %, elapse: 236.582 sec
model saved in Epoch 4
- (Training)   ppl:  103.87097, accuracy: 30.604 %, elapse: 5994.061 sec
- (Validation) ppl:  76.57870, accuracy: 33.876 %, elapse: 237.032 sec
model saved in Epoch 5
- (Training)   ppl:  65.27061, accuracy: 35.676 %, elapse: 6039.870 sec
- (Validation) ppl:  49.84808, accuracy: 38.731 %, elapse: 254.853 sec
model saved in Epoch 6
- (Training)   ppl:  45.85265, accuracy: 39.782 %, elapse: 6124.746 sec
- (Validation) ppl:  36.11635, accuracy: 42.484 %, elapse: 255.023 sec
model saved in Epoch 7
- (Training)   ppl:  34.98754, accuracy: 42.644 %, elapse: 7209.194 sec
- (Validation) ppl:  28.90677, accuracy: 44.593 %, elapse: 283.529 sec
model saved in Epoch 8
- (Training)   ppl:  28.20198, accuracy: 44.773 %, elapse: 7517.610 sec
- (Validation) ppl:  23.14053, accuracy: 46.759 %, elapse: 287.355 sec
model saved in Epoch 9
- (Training)   ppl:  23.75440, accuracy: 46.419 %, elapse: 7523.298 sec
- (Validation) ppl:  20.01043, accuracy: 47.968 %, elapse: 298.202 sec
model saved in Epoch 10
- (Training)   ppl:  20.68477, accuracy: 47.692 %, elapse: 7540.145 sec
- (Validation) ppl:  17.69590, accuracy: 49.386 %, elapse: 287.545 sec
model saved in Epoch 11
- (Training)   ppl:  18.52312, accuracy: 48.693 %, elapse: 7525.626 sec
- (Validation) ppl:  15.68699, accuracy: 50.697 %, elapse: 291.211 sec
model saved in Epoch 12
- (Training)   ppl:  16.69336, accuracy: 49.757 %, elapse: 7541.835 sec
- (Validation) ppl:  14.14964, accuracy: 51.956 %, elapse: 291.653 sec
model saved in Epoch 13
- (Training)   ppl:  15.05456, accuracy: 50.867 %, elapse: 7553.960 sec
- (Validation) ppl:  12.77769, accuracy: 53.154 %, elapse: 307.526 sec
model saved in Epoch 14
- (Training)   ppl:  13.73845, accuracy: 51.911 %, elapse: 7457.978 sec
- (Validation) ppl:  11.72171, accuracy: 54.246 %, elapse: 284.965 sec
model saved in Epoch 15
- (Training)   ppl:  12.71745, accuracy: 52.825 %, elapse: 7502.034 sec
- (Validation) ppl:  10.92034, accuracy: 55.316 %, elapse: 293.485 sec
model saved in Epoch 16
- (Training)   ppl:  11.84027, accuracy: 53.673 %, elapse: 7542.882 sec
- (Validation) ppl:  10.15421, accuracy: 56.183 %, elapse: 309.469 sec
model saved in Epoch 17
- (Training)   ppl:  11.10125, accuracy: 54.462 %, elapse: 6614.099 sec
- (Validation) ppl:  9.59501, accuracy: 56.943 %, elapse: 188.818 sec
model saved in Epoch 18
- (Training)   ppl:  10.46487, accuracy: 55.195 %, elapse: 4800.165 sec
- (Validation) ppl:  9.02364, accuracy: 57.757 %, elapse: 187.094 sec
model saved in Epoch 19
- (Training)   ppl:  9.90866, accuracy: 55.929 %, elapse: 4788.414 sec
- (Validation) ppl:  8.68002, accuracy: 58.280 %, elapse: 186.051 sec
model saved in Epoch 20
- (Training)   ppl:  9.45515, accuracy: 56.497 %, elapse: 4793.429 sec
- (Validation) ppl:  8.22942, accuracy: 59.133 %, elapse: 186.477 sec
model saved in Epoch 21
- (Training)   ppl:  9.00879, accuracy: 57.120 %, elapse: 4782.184 sec
- (Validation) ppl:  7.90966, accuracy: 59.699 %, elapse: 189.138 sec
model saved in Epoch 22
- (Training)   ppl:  8.63208, accuracy: 57.713 %, elapse: 4733.649 sec
- (Validation) ppl:  7.55152, accuracy: 60.558 %, elapse: 167.254 sec
model saved in Epoch 23
- (Training)   ppl:  8.30581, accuracy: 58.217 %, elapse: 4279.418 sec
- (Validation) ppl:  7.36363, accuracy: 60.886 %, elapse: 167.743 sec
model saved in Epoch 24
- (Training)   ppl:  8.01403, accuracy: 58.686 %, elapse: 4474.330 sec
- (Validation) ppl:  7.07995, accuracy: 61.465 %, elapse: 175.503 sec
model saved in Epoch 25
- (Training)   ppl:  7.72752, accuracy: 59.186 %, elapse: 4341.326 sec
- (Validation) ppl:  6.85526, accuracy: 61.833 %, elapse: 167.614 sec
model saved in Epoch 26
- (Training)   ppl:  7.49363, accuracy: 59.581 %, elapse: 4280.469 sec
- (Validation) ppl:  6.67324, accuracy: 62.307 %, elapse: 168.088 sec
model saved in Epoch 27
- (Training)   ppl:  7.27054, accuracy: 60.016 %, elapse: 4273.490 sec
- (Validation) ppl:  6.50993, accuracy: 62.939 %, elapse: 167.445 sec
model saved in Epoch 28
- (Training)   ppl:  7.06656, accuracy: 60.430 %, elapse: 4558.218 sec
- (Validation) ppl:  6.31235, accuracy: 63.085 %, elapse: 176.439 sec
model saved in Epoch 29
- (Training)   ppl:  6.88003, accuracy: 60.700 %, elapse: 4533.170 sec
- (Validation) ppl:  6.21821, accuracy: 63.326 %, elapse: 175.550 sec
model saved in Epoch 30
- (Training)   ppl:  6.68934, accuracy: 61.120 %, elapse: 4877.608 sec
- (Validation) ppl:  6.01507, accuracy: 64.061 %, elapse: 200.626 sec
model saved in Epoch 31
- (Training)   ppl:  6.51866, accuracy: 61.464 %, elapse: 5049.406 sec
- (Validation) ppl:  5.90567, accuracy: 64.266 %, elapse: 199.532 sec
model saved in Epoch 32
- (Training)   ppl:  6.37564, accuracy: 61.808 %, elapse: 5077.477 sec
- (Validation) ppl:  5.73774, accuracy: 64.652 %, elapse: 197.149 sec
model saved in Epoch 33
- (Training)   ppl:  6.22782, accuracy: 62.096 %, elapse: 5089.525 sec
- (Validation) ppl:  5.68392, accuracy: 64.812 %, elapse: 201.219 sec
model saved in Epoch 34
- (Training)   ppl:  6.09790, accuracy: 62.426 %, elapse: 5092.017 sec
- (Validation) ppl:  5.52169, accuracy: 65.440 %, elapse: 201.557 sec
model saved in Epoch 35
- (Training)   ppl:  5.96210, accuracy: 62.715 %, elapse: 5092.141 sec
- (Validation) ppl:  5.41910, accuracy: 65.584 %, elapse: 199.644 sec
model saved in Epoch 36
- (Training)   ppl:  5.86061, accuracy: 62.938 %, elapse: 5093.536 sec
- (Validation) ppl:  5.35973, accuracy: 65.804 %, elapse: 196.768 sec
model saved in Epoch 37
- (Training)   ppl:  5.73975, accuracy: 63.252 %, elapse: 5131.203 sec
- (Validation) ppl:  5.29767, accuracy: 66.182 %, elapse: 199.641 sec
model saved in Epoch 38
- (Training)   ppl:  5.63512, accuracy: 63.518 %, elapse: 5072.205 sec
- (Validation) ppl:  5.19212, accuracy: 66.487 %, elapse: 200.105 sec
model saved in Epoch 39
- (Training)   ppl:  5.53457, accuracy: 63.760 %, elapse: 5096.720 sec
- (Validation) ppl:  5.10707, accuracy: 66.801 %, elapse: 196.970 sec
model saved in Epoch 40
- (Training)   ppl:  5.43695, accuracy: 63.991 %, elapse: 5087.156 sec
- (Validation) ppl:  5.06580, accuracy: 66.726 %, elapse: 199.058 sec
model saved in Epoch 41
- (Training)   ppl:  5.35665, accuracy: 64.208 %, elapse: 5099.644 sec
- (Validation) ppl:  4.99072, accuracy: 66.968 %, elapse: 198.462 sec
model saved in Epoch 42
- (Training)   ppl:  5.27112, accuracy: 64.468 %, elapse: 5058.189 sec
- (Validation) ppl:  4.87638, accuracy: 67.525 %, elapse: 199.427 sec
model saved in Epoch 43
- (Training)   ppl:  5.18321, accuracy: 64.681 %, elapse: 5066.308 sec
- (Validation) ppl:  4.84224, accuracy: 67.788 %, elapse: 198.216 sec
model saved in Epoch 44
- (Training)   ppl:  5.09816, accuracy: 64.957 %, elapse: 5089.255 sec
- (Validation) ppl:  4.77646, accuracy: 67.782 %, elapse: 202.529 sec
model saved in Epoch 45
- (Training)   ppl:  5.03538, accuracy: 65.048 %, elapse: 5078.389 sec
- (Validation) ppl:  4.75108, accuracy: 67.989 %, elapse: 198.926 sec
model saved in Epoch 46
- (Training)   ppl:  4.96260, accuracy: 65.365 %, elapse: 5088.156 sec
- (Validation) ppl:  4.66481, accuracy: 68.427 %, elapse: 200.315 sec
model saved in Epoch 47
- (Training)   ppl:  4.89769, accuracy: 65.570 %, elapse: 5089.895 sec
- (Validation) ppl:  4.63923, accuracy: 68.177 %, elapse: 198.631 sec
model saved in Epoch 48
- (Training)   ppl:  4.82900, accuracy: 65.737 %, elapse: 4948.960 sec
- (Validation) ppl:  4.56613, accuracy: 68.480 %, elapse: 178.954 sec
model saved in Epoch 49
- (Training)   ppl:  4.76820, accuracy: 65.901 %, elapse: 4492.536 sec
- (Validation) ppl:  4.51695, accuracy: 68.732 %, elapse: 176.633 sec
model saved in Epoch 50
