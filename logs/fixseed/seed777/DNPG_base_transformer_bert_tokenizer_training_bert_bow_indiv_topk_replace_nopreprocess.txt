Config: {'save_model_path': '../models/DNPG_base_transformer_bert_tokenizer_bert_bow_indivtopk_replace_nopreprocess.pth', 'log_file': '../logs/DNPG_base_transformer_bert_tokenizer_training_bert_bow_indiv_topk_replace_nopreprocess.txt', 'test_output_file': '../outputs/test_DNPG_transformer_bert_tokenizer_bow_indivtopk_replace_out_nopreprocess.txt', 'val_output_file': '../outputs/val_DNPG_transformer_bert_tokenizer_bow_indivtopk_replace_out_nopreprocess.txt', 'dataset': 'quora_bert_mask_predict_dataset', 'num_epochs': 50, 'batch_size': 100, 'd_model': 450, 'd_inner_hid': 512, 'd_k': 50, 'd_v': 50, 'n_head': 9, 'n_layers': 3, 'n_warmup_steps': 12000, 'dropout': 0.1, 'embs_share_weight': True, 'proj_share_weight': True, 'label_smoothing': False, 'train_size': 100000, 'val_size': 4000, 'test_size': 20000, 'is_bow': True, 'bow_strategy': 'indiv_topk', 'indiv_topk': 10, 'topk': 25, 'lr': '1e-3', 'only_bow': False, 'replace_predict': True, 'append_bow': True}
- (Training)   ppl:  20160.34124, accuracy: 7.238 %, elapse: 3262.451 sec
- (Validation) ppl:  9781.24353, accuracy: 7.521 %, elapse: 124.085 sec
model saved in Epoch 1
- (Training)   ppl:  2758.14924, accuracy: 8.085 %, elapse: 3262.978 sec
- (Validation) ppl:  767.03903, accuracy: 13.353 %, elapse: 124.290 sec
model saved in Epoch 2
- (Training)   ppl:  444.43305, accuracy: 15.507 %, elapse: 3266.936 sec
- (Validation) ppl:  251.59004, accuracy: 21.769 %, elapse: 123.925 sec
model saved in Epoch 3
- (Training)   ppl:  182.57641, accuracy: 24.647 %, elapse: 3268.311 sec
- (Validation) ppl:  128.70579, accuracy: 27.675 %, elapse: 124.164 sec
model saved in Epoch 4
- (Training)   ppl:  99.26584, accuracy: 31.248 %, elapse: 3263.821 sec
- (Validation) ppl:  69.94866, accuracy: 34.613 %, elapse: 126.840 sec
model saved in Epoch 5
- (Training)   ppl:  59.23391, accuracy: 37.090 %, elapse: 3272.327 sec
- (Validation) ppl:  44.22125, accuracy: 40.538 %, elapse: 134.745 sec
model saved in Epoch 6
- (Training)   ppl:  39.84758, accuracy: 41.767 %, elapse: 3701.132 sec
- (Validation) ppl:  30.72966, accuracy: 44.644 %, elapse: 144.654 sec
model saved in Epoch 7
- (Training)   ppl:  28.80112, accuracy: 45.216 %, elapse: 3814.595 sec
- (Validation) ppl:  22.80625, accuracy: 47.681 %, elapse: 146.232 sec
model saved in Epoch 8
- (Training)   ppl:  22.20983, accuracy: 47.885 %, elapse: 3819.310 sec
- (Validation) ppl:  17.87653, accuracy: 50.403 %, elapse: 145.482 sec
model saved in Epoch 9
- (Training)   ppl:  18.05547, accuracy: 50.047 %, elapse: 3781.369 sec
- (Validation) ppl:  14.82656, accuracy: 52.419 %, elapse: 145.844 sec
model saved in Epoch 10
- (Training)   ppl:  15.32265, accuracy: 51.731 %, elapse: 3846.935 sec
- (Validation) ppl:  12.63601, accuracy: 54.119 %, elapse: 155.467 sec
model saved in Epoch 11
- (Training)   ppl:  13.46543, accuracy: 53.070 %, elapse: 4059.822 sec
- (Validation) ppl:  11.35635, accuracy: 55.378 %, elapse: 147.645 sec
model saved in Epoch 12
- (Training)   ppl:  11.98306, accuracy: 54.321 %, elapse: 3791.902 sec
- (Validation) ppl:  10.03334, accuracy: 56.894 %, elapse: 146.427 sec
model saved in Epoch 13
- (Training)   ppl:  10.73137, accuracy: 55.535 %, elapse: 3812.416 sec
- (Validation) ppl:  9.06589, accuracy: 58.129 %, elapse: 145.184 sec
model saved in Epoch 14
- (Training)   ppl:  9.71161, accuracy: 56.754 %, elapse: 3811.652 sec
- (Validation) ppl:  8.12457, accuracy: 59.573 %, elapse: 145.809 sec
model saved in Epoch 15
- (Training)   ppl:  8.89785, accuracy: 57.806 %, elapse: 3637.325 sec
- (Validation) ppl:  7.58858, accuracy: 60.534 %, elapse: 124.979 sec
model saved in Epoch 16
- (Training)   ppl:  8.22090, accuracy: 58.763 %, elapse: 3280.746 sec
- (Validation) ppl:  7.03728, accuracy: 61.651 %, elapse: 124.358 sec
model saved in Epoch 17
- (Training)   ppl:  7.67827, accuracy: 59.673 %, elapse: 3271.010 sec
- (Validation) ppl:  6.63415, accuracy: 62.538 %, elapse: 124.461 sec
model saved in Epoch 18
- (Training)   ppl:  7.20868, accuracy: 60.505 %, elapse: 3270.499 sec
- (Validation) ppl:  6.26191, accuracy: 63.351 %, elapse: 123.945 sec
model saved in Epoch 19
- (Training)   ppl:  6.79427, accuracy: 61.290 %, elapse: 3270.905 sec
- (Validation) ppl:  5.98170, accuracy: 64.088 %, elapse: 124.547 sec
model saved in Epoch 20
- (Training)   ppl:  6.43738, accuracy: 62.008 %, elapse: 3271.178 sec
- (Validation) ppl:  5.68909, accuracy: 64.719 %, elapse: 124.471 sec
model saved in Epoch 21
- (Training)   ppl:  6.12893, accuracy: 62.686 %, elapse: 3271.807 sec
- (Validation) ppl:  5.42437, accuracy: 65.671 %, elapse: 124.442 sec
model saved in Epoch 22
- (Training)   ppl:  5.85024, accuracy: 63.341 %, elapse: 3273.727 sec
- (Validation) ppl:  5.20735, accuracy: 66.314 %, elapse: 124.199 sec
model saved in Epoch 23
- (Training)   ppl:  5.60993, accuracy: 63.914 %, elapse: 3272.208 sec
- (Validation) ppl:  5.02247, accuracy: 66.622 %, elapse: 124.591 sec
model saved in Epoch 24
- (Training)   ppl:  5.39033, accuracy: 64.487 %, elapse: 3275.089 sec
- (Validation) ppl:  4.82851, accuracy: 67.397 %, elapse: 124.167 sec
model saved in Epoch 25
- (Training)   ppl:  5.19227, accuracy: 64.983 %, elapse: 3274.739 sec
- (Validation) ppl:  4.72941, accuracy: 67.794 %, elapse: 124.493 sec
model saved in Epoch 26
- (Training)   ppl:  5.01006, accuracy: 65.538 %, elapse: 3272.229 sec
- (Validation) ppl:  4.54912, accuracy: 68.200 %, elapse: 124.571 sec
model saved in Epoch 27
- (Training)   ppl:  4.83704, accuracy: 65.998 %, elapse: 3272.550 sec
- (Validation) ppl:  4.39869, accuracy: 68.925 %, elapse: 124.431 sec
model saved in Epoch 28
- (Training)   ppl:  4.68502, accuracy: 66.471 %, elapse: 3277.694 sec
- (Validation) ppl:  4.30286, accuracy: 69.166 %, elapse: 124.743 sec
model saved in Epoch 29
- (Training)   ppl:  4.54952, accuracy: 66.940 %, elapse: 3280.529 sec
- (Validation) ppl:  4.17824, accuracy: 69.819 %, elapse: 124.831 sec
model saved in Epoch 30
- (Training)   ppl:  4.41340, accuracy: 67.338 %, elapse: 3279.268 sec
- (Validation) ppl:  4.06641, accuracy: 70.426 %, elapse: 124.353 sec
model saved in Epoch 31
- (Training)   ppl:  4.28844, accuracy: 67.812 %, elapse: 3282.563 sec
- (Validation) ppl:  3.98491, accuracy: 70.685 %, elapse: 124.535 sec
model saved in Epoch 32
- (Training)   ppl:  4.18129, accuracy: 68.184 %, elapse: 3278.067 sec
- (Validation) ppl:  3.88902, accuracy: 71.152 %, elapse: 124.534 sec
model saved in Epoch 33
- (Training)   ppl:  4.08054, accuracy: 68.556 %, elapse: 3277.607 sec
- (Validation) ppl:  3.80735, accuracy: 71.428 %, elapse: 124.316 sec
model saved in Epoch 34
- (Training)   ppl:  3.97623, accuracy: 68.981 %, elapse: 3276.258 sec
- (Validation) ppl:  3.71903, accuracy: 71.926 %, elapse: 124.285 sec
model saved in Epoch 35
- (Training)   ppl:  3.88172, accuracy: 69.336 %, elapse: 3286.771 sec
- (Validation) ppl:  3.63288, accuracy: 72.268 %, elapse: 125.227 sec
model saved in Epoch 36
- (Training)   ppl:  3.80363, accuracy: 69.646 %, elapse: 3295.553 sec
- (Validation) ppl:  3.60046, accuracy: 72.515 %, elapse: 124.477 sec
model saved in Epoch 37
- (Training)   ppl:  3.71153, accuracy: 70.024 %, elapse: 3291.893 sec
- (Validation) ppl:  3.53393, accuracy: 72.855 %, elapse: 124.175 sec
model saved in Epoch 38
- (Training)   ppl:  3.63047, accuracy: 70.400 %, elapse: 3273.427 sec
- (Validation) ppl:  3.47374, accuracy: 73.115 %, elapse: 124.337 sec
model saved in Epoch 39
- (Training)   ppl:  3.55959, accuracy: 70.682 %, elapse: 3271.705 sec
- (Validation) ppl:  3.42386, accuracy: 73.536 %, elapse: 124.636 sec
model saved in Epoch 40
- (Training)   ppl:  3.48929, accuracy: 71.005 %, elapse: 3269.735 sec
- (Validation) ppl:  3.35151, accuracy: 73.805 %, elapse: 123.970 sec
model saved in Epoch 41
- (Training)   ppl:  3.42653, accuracy: 71.304 %, elapse: 3268.961 sec
- (Validation) ppl:  3.32782, accuracy: 73.993 %, elapse: 124.261 sec
model saved in Epoch 42
- (Training)   ppl:  3.36736, accuracy: 71.590 %, elapse: 3262.983 sec
- (Validation) ppl:  3.26711, accuracy: 74.386 %, elapse: 123.731 sec
model saved in Epoch 43
- (Training)   ppl:  3.30096, accuracy: 71.906 %, elapse: 3264.620 sec
- (Validation) ppl:  3.21177, accuracy: 74.811 %, elapse: 124.095 sec
model saved in Epoch 44
- (Training)   ppl:  3.24319, accuracy: 72.217 %, elapse: 3257.527 sec
- (Validation) ppl:  3.17362, accuracy: 75.108 %, elapse: 123.781 sec
model saved in Epoch 45
- (Training)   ppl:  3.19105, accuracy: 72.477 %, elapse: 3269.678 sec
- (Validation) ppl:  3.12826, accuracy: 75.324 %, elapse: 124.469 sec
model saved in Epoch 46
- (Training)   ppl:  3.14899, accuracy: 72.717 %, elapse: 3272.041 sec
- (Validation) ppl:  3.13332, accuracy: 75.320 %, elapse: 124.181 sec
- (Training)   ppl:  3.09852, accuracy: 72.969 %, elapse: 3276.526 sec
- (Validation) ppl:  3.08351, accuracy: 75.593 %, elapse: 124.005 sec
model saved in Epoch 48
- (Training)   ppl:  3.04653, accuracy: 73.288 %, elapse: 3270.427 sec
- (Validation) ppl:  3.04100, accuracy: 75.815 %, elapse: 123.976 sec
model saved in Epoch 49
- (Training)   ppl:  2.99927, accuracy: 73.534 %, elapse: 3351.832 sec
- (Validation) ppl:  2.99886, accuracy: 76.050 %, elapse: 124.848 sec
model saved in Epoch 50
