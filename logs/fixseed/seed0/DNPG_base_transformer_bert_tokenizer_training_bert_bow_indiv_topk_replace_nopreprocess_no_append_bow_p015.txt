Config: {'save_model_path': '../models/DNPG_base_transformer_bert_tokenizer_bert_bow_indivtopk_replace_nopreprocess_no_append_bow_p015.pth', 'log_file': '../logs/DNPG_base_transformer_bert_tokenizer_training_bert_bow_indiv_topk_replace_nopreprocess_no_append_bow_p015.txt', 'test_output_file': '../outputs/test_DNPG_transformer_bert_tokenizer_bow_indivtopk_replace_out_nopreprocess_no_append_bow_p015.txt', 'val_output_file': '../outputs/val_DNPG_transformer_bert_tokenizer_bow_indivtopk_replace_out_nopreprocess_no_append_bow_p015.txt', 'dataset': 'quora_bert_mask_predict_dataset', 'num_epochs': 50, 'batch_size': 100, 'd_model': 450, 'd_inner_hid': 512, 'd_k': 50, 'd_v': 50, 'n_head': 9, 'n_layers': 3, 'n_warmup_steps': 12000, 'dropout': 0.1, 'embs_share_weight': True, 'proj_share_weight': True, 'label_smoothing': False, 'train_size': 100000, 'val_size': 4000, 'test_size': 20000, 'is_bow': True, 'bow_strategy': 'indiv_topk', 'indiv_topk': 10, 'topk': 25, 'lr': '1e-3', 'only_bow': False, 'replace_predict': True, 'append_bow': False}
- (Training)   ppl:  20139.66281, accuracy: 7.471 %, elapse: 2815.277 sec
- (Validation) ppl:  9805.03462, accuracy: 7.800 %, elapse: 101.537 sec
model saved in Epoch 1
- (Training)   ppl:  2742.87552, accuracy: 9.835 %, elapse: 2788.222 sec
- (Validation) ppl:  780.00337, accuracy: 14.856 %, elapse: 102.696 sec
model saved in Epoch 2
- (Training)   ppl:  439.03545, accuracy: 15.917 %, elapse: 2779.533 sec
- (Validation) ppl:  258.39605, accuracy: 21.932 %, elapse: 101.386 sec
model saved in Epoch 3
- (Training)   ppl:  179.65933, accuracy: 24.799 %, elapse: 2794.387 sec
- (Validation) ppl:  134.72468, accuracy: 28.282 %, elapse: 99.691 sec
model saved in Epoch 4
- (Training)   ppl:  95.80231, accuracy: 32.011 %, elapse: 2788.045 sec
- (Validation) ppl:  68.63764, accuracy: 35.812 %, elapse: 103.515 sec
model saved in Epoch 5
- (Training)   ppl:  55.46995, accuracy: 38.306 %, elapse: 2792.373 sec
- (Validation) ppl:  41.72254, accuracy: 41.803 %, elapse: 102.945 sec
model saved in Epoch 6
- (Training)   ppl:  36.02770, accuracy: 43.368 %, elapse: 2780.453 sec
- (Validation) ppl:  27.30682, accuracy: 47.040 %, elapse: 103.207 sec
model saved in Epoch 7
- (Training)   ppl:  25.60936, accuracy: 47.282 %, elapse: 2786.372 sec
- (Validation) ppl:  19.71174, accuracy: 50.723 %, elapse: 102.530 sec
model saved in Epoch 8
- (Training)   ppl:  19.58109, accuracy: 50.502 %, elapse: 2813.931 sec
- (Validation) ppl:  15.80018, accuracy: 53.808 %, elapse: 103.314 sec
model saved in Epoch 9
- (Training)   ppl:  16.01140, accuracy: 52.828 %, elapse: 2780.798 sec
- (Validation) ppl:  12.77317, accuracy: 56.170 %, elapse: 103.563 sec
model saved in Epoch 10
- (Training)   ppl:  13.68911, accuracy: 54.575 %, elapse: 2789.062 sec
- (Validation) ppl:  11.39827, accuracy: 57.247 %, elapse: 102.606 sec
model saved in Epoch 11
- (Training)   ppl:  12.16915, accuracy: 55.729 %, elapse: 2787.394 sec
- (Validation) ppl:  10.14622, accuracy: 58.845 %, elapse: 101.415 sec
model saved in Epoch 12
- (Training)   ppl:  10.86472, accuracy: 57.047 %, elapse: 2784.466 sec
- (Validation) ppl:  9.04571, accuracy: 59.887 %, elapse: 101.958 sec
model saved in Epoch 13
- (Training)   ppl:  9.75313, accuracy: 58.278 %, elapse: 2781.530 sec
- (Validation) ppl:  8.19085, accuracy: 61.240 %, elapse: 101.716 sec
model saved in Epoch 14
- (Training)   ppl:  8.87924, accuracy: 59.483 %, elapse: 2780.900 sec
- (Validation) ppl:  7.32741, accuracy: 62.960 %, elapse: 103.726 sec
model saved in Epoch 15
- (Training)   ppl:  8.18768, accuracy: 60.489 %, elapse: 2792.737 sec
- (Validation) ppl:  6.85996, accuracy: 63.800 %, elapse: 103.155 sec
model saved in Epoch 16
- (Training)   ppl:  7.63643, accuracy: 61.376 %, elapse: 2784.523 sec
- (Validation) ppl:  6.55524, accuracy: 64.299 %, elapse: 102.033 sec
model saved in Epoch 17
- (Training)   ppl:  7.16869, accuracy: 62.204 %, elapse: 2783.242 sec
- (Validation) ppl:  6.29202, accuracy: 64.782 %, elapse: 103.672 sec
model saved in Epoch 18
- (Training)   ppl:  6.77665, accuracy: 62.940 %, elapse: 2790.460 sec
- (Validation) ppl:  5.85552, accuracy: 65.981 %, elapse: 103.606 sec
model saved in Epoch 19
- (Training)   ppl:  6.43357, accuracy: 63.619 %, elapse: 2794.766 sec
- (Validation) ppl:  5.63842, accuracy: 66.349 %, elapse: 104.344 sec
model saved in Epoch 20
- (Training)   ppl:  6.13728, accuracy: 64.280 %, elapse: 2800.929 sec
- (Validation) ppl:  5.44922, accuracy: 66.746 %, elapse: 102.586 sec
model saved in Epoch 21
- (Training)   ppl:  5.87496, accuracy: 64.868 %, elapse: 2791.797 sec
- (Validation) ppl:  5.12989, accuracy: 67.702 %, elapse: 103.263 sec
model saved in Epoch 22
- (Training)   ppl:  5.64992, accuracy: 65.389 %, elapse: 2806.903 sec
- (Validation) ppl:  5.25621, accuracy: 67.026 %, elapse: 101.413 sec
- (Training)   ppl:  5.44885, accuracy: 65.893 %, elapse: 2801.090 sec
- (Validation) ppl:  4.83099, accuracy: 68.632 %, elapse: 104.508 sec
model saved in Epoch 24
- (Training)   ppl:  5.27171, accuracy: 66.395 %, elapse: 2798.308 sec
- (Validation) ppl:  4.67920, accuracy: 68.849 %, elapse: 100.000 sec
model saved in Epoch 25
- (Training)   ppl:  5.10879, accuracy: 66.863 %, elapse: 2793.054 sec
- (Validation) ppl:  4.66646, accuracy: 69.181 %, elapse: 102.777 sec
model saved in Epoch 26
- (Training)   ppl:  4.96049, accuracy: 67.245 %, elapse: 2810.014 sec
- (Validation) ppl:  4.52246, accuracy: 69.459 %, elapse: 103.384 sec
model saved in Epoch 27
- (Training)   ppl:  4.82313, accuracy: 67.668 %, elapse: 2834.293 sec
- (Validation) ppl:  4.46034, accuracy: 69.663 %, elapse: 103.144 sec
model saved in Epoch 28
- (Training)   ppl:  4.68727, accuracy: 68.097 %, elapse: 2803.481 sec
- (Validation) ppl:  4.35785, accuracy: 70.184 %, elapse: 103.165 sec
model saved in Epoch 29
- (Training)   ppl:  4.57978, accuracy: 68.425 %, elapse: 2792.950 sec
- (Validation) ppl:  4.27969, accuracy: 70.508 %, elapse: 102.564 sec
model saved in Epoch 30
- (Training)   ppl:  4.48289, accuracy: 68.739 %, elapse: 2815.167 sec
- (Validation) ppl:  4.09437, accuracy: 71.009 %, elapse: 102.168 sec
model saved in Epoch 31
- (Training)   ppl:  4.37880, accuracy: 69.097 %, elapse: 2825.213 sec
- (Validation) ppl:  3.97901, accuracy: 71.436 %, elapse: 103.466 sec
model saved in Epoch 32
- (Training)   ppl:  4.28076, accuracy: 69.408 %, elapse: 2798.696 sec
- (Validation) ppl:  3.94798, accuracy: 71.761 %, elapse: 102.929 sec
model saved in Epoch 33
- (Training)   ppl:  4.19869, accuracy: 69.665 %, elapse: 2800.006 sec
- (Validation) ppl:  3.86037, accuracy: 72.079 %, elapse: 104.025 sec
model saved in Epoch 34
- (Training)   ppl:  4.11991, accuracy: 69.974 %, elapse: 2791.062 sec
- (Validation) ppl:  3.83556, accuracy: 72.288 %, elapse: 104.092 sec
model saved in Epoch 35
- (Training)   ppl:  4.03739, accuracy: 70.307 %, elapse: 2791.701 sec
- (Validation) ppl:  3.71997, accuracy: 72.657 %, elapse: 103.836 sec
model saved in Epoch 36
- (Training)   ppl:  3.97730, accuracy: 70.528 %, elapse: 2790.956 sec
- (Validation) ppl:  3.70647, accuracy: 72.590 %, elapse: 104.448 sec
model saved in Epoch 37
- (Training)   ppl:  3.90873, accuracy: 70.775 %, elapse: 2791.251 sec
- (Validation) ppl:  3.61357, accuracy: 73.068 %, elapse: 101.299 sec
model saved in Epoch 38
- (Training)   ppl:  3.85003, accuracy: 71.012 %, elapse: 2790.104 sec
- (Validation) ppl:  3.60981, accuracy: 73.217 %, elapse: 104.544 sec
model saved in Epoch 39
- (Training)   ppl:  3.79773, accuracy: 71.213 %, elapse: 2799.269 sec
- (Validation) ppl:  3.52884, accuracy: 73.415 %, elapse: 104.138 sec
model saved in Epoch 40
- (Training)   ppl:  3.73914, accuracy: 71.434 %, elapse: 2794.191 sec
- (Validation) ppl:  3.53395, accuracy: 73.494 %, elapse: 103.024 sec
- (Training)   ppl:  3.67810, accuracy: 71.684 %, elapse: 2791.139 sec
- (Validation) ppl:  3.43650, accuracy: 73.970 %, elapse: 102.921 sec
model saved in Epoch 42
- (Training)   ppl:  3.63192, accuracy: 71.862 %, elapse: 2785.514 sec
- (Validation) ppl:  3.50626, accuracy: 73.576 %, elapse: 103.447 sec
- (Training)   ppl:  3.57901, accuracy: 72.117 %, elapse: 2784.137 sec
- (Validation) ppl:  3.39189, accuracy: 74.132 %, elapse: 104.429 sec
model saved in Epoch 44
- (Training)   ppl:  3.53602, accuracy: 72.300 %, elapse: 2793.860 sec
- (Validation) ppl:  3.32770, accuracy: 74.295 %, elapse: 102.417 sec
model saved in Epoch 45
- (Training)   ppl:  3.49133, accuracy: 72.500 %, elapse: 2791.108 sec
- (Validation) ppl:  3.33216, accuracy: 74.396 %, elapse: 102.554 sec
- (Training)   ppl:  3.44966, accuracy: 72.659 %, elapse: 2783.792 sec
- (Validation) ppl:  3.25631, accuracy: 75.017 %, elapse: 102.996 sec
model saved in Epoch 47
- (Training)   ppl:  3.40551, accuracy: 72.888 %, elapse: 2786.675 sec
- (Validation) ppl:  3.30865, accuracy: 74.642 %, elapse: 102.772 sec
- (Training)   ppl:  3.37151, accuracy: 73.064 %, elapse: 2790.412 sec
- (Validation) ppl:  3.17739, accuracy: 75.335 %, elapse: 104.976 sec
model saved in Epoch 49
- (Training)   ppl:  3.33229, accuracy: 73.221 %, elapse: 3046.212 sec
- (Validation) ppl:  3.22529, accuracy: 75.021 %, elapse: 126.328 sec
