Config: {'save_model_path': '../models/DNPG_base_transformer_bert_tokenizer_bert_bow_indivtopk.pth', 'log_file': '../logs/DNPG_base_transformer_bert_tokenizer_training_bert_bow_indiv_topk.txt', 'test_output_file': '../outputs/test_DNPG_transformer_bert_tokenizer_bow_indivtopk_out.txt', 'val_output_file': '../outputs/val_DNPG_transformer_bert_tokenizer_bow_indivtopk_out.txt', 'dataset': 'quora_bert_mask_predict_dataset', 'num_epochs': 50, 'batch_size': 100, 'd_model': 450, 'd_inner_hid': 512, 'd_k': 50, 'd_v': 50, 'n_head': 9, 'n_layers': 3, 'n_warmup_steps': 12000, 'dropout': 0.1, 'embs_share_weight': True, 'proj_share_weight': True, 'label_smoothing': False, 'train_size': 100000, 'val_size': 4000, 'test_size': 20000, 'is_bow': True, 'bow_strategy': 'indiv_topk', 'indiv_topk': 10, 'topk': 50, 'lr': '1e-3', 'only_bow': False, 'replace_predict': False, 'append_bow': True}
- (Training)   ppl:  20136.35568, accuracy: 7.558 %, elapse: 150.324 sec
- (Validation) ppl:  9780.01678, accuracy: 7.760 %, elapse: 2.077 sec
model saved in Epoch 1
- (Training)   ppl:  2747.56095, accuracy: 7.835 %, elapse: 151.341 sec
- (Validation) ppl:  769.28048, accuracy: 7.760 %, elapse: 2.090 sec
model saved in Epoch 2
- (Training)   ppl:  441.67543, accuracy: 13.467 %, elapse: 151.649 sec
- (Validation) ppl:  253.57495, accuracy: 21.785 %, elapse: 2.104 sec
model saved in Epoch 3
- (Training)   ppl:  178.54707, accuracy: 24.741 %, elapse: 151.728 sec
- (Validation) ppl:  122.81685, accuracy: 29.451 %, elapse: 2.097 sec
model saved in Epoch 4
- (Training)   ppl:  94.07027, accuracy: 32.344 %, elapse: 152.169 sec
- (Validation) ppl:  65.21509, accuracy: 36.558 %, elapse: 2.107 sec
model saved in Epoch 5
- (Training)   ppl:  53.69157, accuracy: 38.806 %, elapse: 152.267 sec
- (Validation) ppl:  39.18732, accuracy: 42.761 %, elapse: 2.095 sec
model saved in Epoch 6
- (Training)   ppl:  33.88813, accuracy: 44.269 %, elapse: 152.386 sec
- (Validation) ppl:  25.71172, accuracy: 47.904 %, elapse: 2.103 sec
model saved in Epoch 7
- (Training)   ppl:  23.29554, accuracy: 48.702 %, elapse: 152.340 sec
- (Validation) ppl:  18.53359, accuracy: 52.124 %, elapse: 2.101 sec
model saved in Epoch 8
- (Training)   ppl:  17.36681, accuracy: 52.265 %, elapse: 152.176 sec
- (Validation) ppl:  14.67579, accuracy: 55.200 %, elapse: 2.103 sec
model saved in Epoch 9
- (Training)   ppl:  13.90383, accuracy: 54.905 %, elapse: 152.276 sec
- (Validation) ppl:  12.16960, accuracy: 57.611 %, elapse: 2.107 sec
model saved in Epoch 10
- (Training)   ppl:  11.76841, accuracy: 56.793 %, elapse: 152.095 sec
- (Validation) ppl:  10.90900, accuracy: 58.977 %, elapse: 2.104 sec
model saved in Epoch 11
- (Training)   ppl:  10.42197, accuracy: 57.976 %, elapse: 152.403 sec
- (Validation) ppl:  9.83305, accuracy: 59.804 %, elapse: 2.106 sec
model saved in Epoch 12
- (Training)   ppl:  9.33481, accuracy: 59.182 %, elapse: 152.083 sec
- (Validation) ppl:  8.96169, accuracy: 61.029 %, elapse: 2.102 sec
model saved in Epoch 13
- (Training)   ppl:  8.36398, accuracy: 60.473 %, elapse: 151.952 sec
- (Validation) ppl:  8.30021, accuracy: 62.198 %, elapse: 2.100 sec
model saved in Epoch 14
- (Training)   ppl:  7.58912, accuracy: 61.595 %, elapse: 152.284 sec
- (Validation) ppl:  7.77523, accuracy: 62.597 %, elapse: 2.108 sec
model saved in Epoch 15
- (Training)   ppl:  7.00699, accuracy: 62.589 %, elapse: 152.244 sec
- (Validation) ppl:  7.37250, accuracy: 63.738 %, elapse: 2.104 sec
model saved in Epoch 16
- (Training)   ppl:  6.50084, accuracy: 63.555 %, elapse: 152.559 sec
- (Validation) ppl:  7.04555, accuracy: 64.376 %, elapse: 2.102 sec
model saved in Epoch 17
- (Training)   ppl:  6.09005, accuracy: 64.397 %, elapse: 151.991 sec
- (Validation) ppl:  6.79711, accuracy: 64.905 %, elapse: 2.104 sec
model saved in Epoch 18
- (Training)   ppl:  5.75158, accuracy: 65.139 %, elapse: 152.153 sec
- (Validation) ppl:  6.40363, accuracy: 65.459 %, elapse: 2.107 sec
model saved in Epoch 19
- (Training)   ppl:  5.45262, accuracy: 65.793 %, elapse: 152.356 sec
- (Validation) ppl:  6.34820, accuracy: 65.872 %, elapse: 2.096 sec
model saved in Epoch 20
- (Training)   ppl:  5.20583, accuracy: 66.411 %, elapse: 152.166 sec
- (Validation) ppl:  6.17228, accuracy: 66.097 %, elapse: 2.101 sec
model saved in Epoch 21
- (Training)   ppl:  4.96683, accuracy: 67.041 %, elapse: 151.904 sec
- (Validation) ppl:  5.99451, accuracy: 66.426 %, elapse: 2.106 sec
model saved in Epoch 22
- (Training)   ppl:  4.77712, accuracy: 67.583 %, elapse: 151.944 sec
- (Validation) ppl:  5.87453, accuracy: 66.839 %, elapse: 2.100 sec
model saved in Epoch 23
- (Training)   ppl:  4.62592, accuracy: 68.019 %, elapse: 152.416 sec
- (Validation) ppl:  5.74311, accuracy: 67.251 %, elapse: 2.101 sec
model saved in Epoch 24
- (Training)   ppl:  4.46665, accuracy: 68.529 %, elapse: 152.290 sec
- (Validation) ppl:  5.67310, accuracy: 67.475 %, elapse: 2.108 sec
model saved in Epoch 25
- (Training)   ppl:  4.30240, accuracy: 69.046 %, elapse: 152.303 sec
- (Validation) ppl:  5.61207, accuracy: 67.855 %, elapse: 2.105 sec
model saved in Epoch 26
- (Training)   ppl:  4.16369, accuracy: 69.528 %, elapse: 152.380 sec
- (Validation) ppl:  5.49511, accuracy: 67.994 %, elapse: 2.099 sec
model saved in Epoch 27
- (Training)   ppl:  4.05595, accuracy: 69.881 %, elapse: 152.172 sec
- (Validation) ppl:  5.46777, accuracy: 68.111 %, elapse: 2.100 sec
model saved in Epoch 28
- (Training)   ppl:  3.94707, accuracy: 70.254 %, elapse: 152.421 sec
- (Validation) ppl:  5.40337, accuracy: 68.413 %, elapse: 2.104 sec
model saved in Epoch 29
- (Training)   ppl:  3.83873, accuracy: 70.669 %, elapse: 152.204 sec
- (Validation) ppl:  5.39105, accuracy: 68.411 %, elapse: 2.110 sec
model saved in Epoch 30
- (Training)   ppl:  3.74543, accuracy: 71.032 %, elapse: 152.410 sec
- (Validation) ppl:  5.34176, accuracy: 68.759 %, elapse: 2.108 sec
model saved in Epoch 31
- (Training)   ppl:  3.65274, accuracy: 71.389 %, elapse: 152.030 sec
- (Validation) ppl:  5.28886, accuracy: 68.835 %, elapse: 2.107 sec
model saved in Epoch 32
- (Training)   ppl:  3.57321, accuracy: 71.707 %, elapse: 152.534 sec
- (Validation) ppl:  5.31819, accuracy: 68.931 %, elapse: 2.100 sec
- (Training)   ppl:  3.49128, accuracy: 72.079 %, elapse: 152.730 sec
- (Validation) ppl:  5.20065, accuracy: 69.159 %, elapse: 2.097 sec
model saved in Epoch 34
- (Training)   ppl:  3.41741, accuracy: 72.369 %, elapse: 152.518 sec
- (Validation) ppl:  5.21986, accuracy: 69.172 %, elapse: 2.104 sec
- (Training)   ppl:  3.34587, accuracy: 72.686 %, elapse: 152.826 sec
- (Validation) ppl:  5.14406, accuracy: 69.526 %, elapse: 2.104 sec
model saved in Epoch 36
- (Training)   ppl:  3.28041, accuracy: 72.990 %, elapse: 152.499 sec
- (Validation) ppl:  5.17365, accuracy: 69.415 %, elapse: 2.103 sec
- (Training)   ppl:  3.22107, accuracy: 73.243 %, elapse: 152.514 sec
- (Validation) ppl:  5.10086, accuracy: 69.453 %, elapse: 2.100 sec
model saved in Epoch 38
- (Training)   ppl:  3.16792, accuracy: 73.516 %, elapse: 152.262 sec
- (Validation) ppl:  5.10450, accuracy: 69.709 %, elapse: 2.108 sec
- (Training)   ppl:  3.11399, accuracy: 73.777 %, elapse: 152.176 sec
- (Validation) ppl:  5.06883, accuracy: 69.793 %, elapse: 2.106 sec
model saved in Epoch 40
- (Training)   ppl:  3.05222, accuracy: 74.088 %, elapse: 152.095 sec
- (Validation) ppl:  5.14043, accuracy: 69.724 %, elapse: 2.100 sec
- (Training)   ppl:  3.01154, accuracy: 74.334 %, elapse: 152.272 sec
- (Validation) ppl:  5.06331, accuracy: 69.889 %, elapse: 2.110 sec
model saved in Epoch 42
- (Training)   ppl:  2.96426, accuracy: 74.560 %, elapse: 152.439 sec
- (Validation) ppl:  5.02612, accuracy: 69.990 %, elapse: 2.105 sec
model saved in Epoch 43
- (Training)   ppl:  2.91763, accuracy: 74.800 %, elapse: 152.338 sec
- (Validation) ppl:  5.04181, accuracy: 70.031 %, elapse: 2.107 sec
- (Training)   ppl:  2.87582, accuracy: 75.028 %, elapse: 152.152 sec
- (Validation) ppl:  5.06257, accuracy: 70.098 %, elapse: 2.099 sec
- (Training)   ppl:  2.83690, accuracy: 75.251 %, elapse: 152.423 sec
- (Validation) ppl:  5.07355, accuracy: 70.388 %, elapse: 2.106 sec
- (Training)   ppl:  2.81089, accuracy: 75.382 %, elapse: 152.113 sec
- (Validation) ppl:  5.10610, accuracy: 70.190 %, elapse: 2.103 sec
- (Training)   ppl:  2.77120, accuracy: 75.636 %, elapse: 152.383 sec
- (Validation) ppl:  5.01744, accuracy: 70.364 %, elapse: 2.102 sec
model saved in Epoch 48
- (Training)   ppl:  2.74435, accuracy: 75.835 %, elapse: 152.115 sec
- (Validation) ppl:  5.05682, accuracy: 70.409 %, elapse: 2.101 sec
- (Training)   ppl:  2.70758, accuracy: 76.005 %, elapse: 152.384 sec
- (Validation) ppl:  5.05400, accuracy: 70.499 %, elapse: 2.102 sec
