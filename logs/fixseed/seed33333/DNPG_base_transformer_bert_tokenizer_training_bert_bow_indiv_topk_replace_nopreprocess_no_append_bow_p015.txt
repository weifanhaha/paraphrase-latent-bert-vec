Config: {'save_model_path': '../models/DNPG_base_transformer_bert_tokenizer_bert_bow_indivtopk_replace_nopreprocess_no_append_bow_p015.pth', 'log_file': '../logs/DNPG_base_transformer_bert_tokenizer_training_bert_bow_indiv_topk_replace_nopreprocess_no_append_bow_p015.txt', 'test_output_file': '../outputs/test_DNPG_transformer_bert_tokenizer_bow_indivtopk_replace_out_nopreprocess_no_append_bow_p015.txt', 'val_output_file': '../outputs/val_DNPG_transformer_bert_tokenizer_bow_indivtopk_replace_out_nopreprocess_no_append_bow_p015.txt', 'dataset': 'quora_bert_mask_predict_dataset', 'num_epochs': 50, 'batch_size': 100, 'd_model': 450, 'd_inner_hid': 512, 'd_k': 50, 'd_v': 50, 'n_head': 9, 'n_layers': 3, 'n_warmup_steps': 12000, 'dropout': 0.1, 'embs_share_weight': True, 'proj_share_weight': True, 'label_smoothing': False, 'train_size': 100000, 'val_size': 4000, 'test_size': 20000, 'is_bow': True, 'bow_strategy': 'indiv_topk', 'indiv_topk': 10, 'topk': 25, 'lr': '1e-3', 'only_bow': False, 'replace_predict': True, 'append_bow': False}
- (Training)   ppl:  20138.30947, accuracy: 7.709 %, elapse: 2310.159 sec
- (Validation) ppl:  9799.62104, accuracy: 7.494 %, elapse: 87.014 sec
model saved in Epoch 1
- (Training)   ppl:  2751.23346, accuracy: 10.961 %, elapse: 2313.812 sec
- (Validation) ppl:  777.55580, accuracy: 14.241 %, elapse: 86.728 sec
model saved in Epoch 2
- (Training)   ppl:  437.83349, accuracy: 16.112 %, elapse: 2307.711 sec
- (Validation) ppl:  258.19715, accuracy: 21.829 %, elapse: 86.738 sec
model saved in Epoch 3
- (Training)   ppl:  180.05809, accuracy: 24.561 %, elapse: 2297.004 sec
- (Validation) ppl:  142.64023, accuracy: 26.948 %, elapse: 86.412 sec
model saved in Epoch 4
- (Training)   ppl:  97.27806, accuracy: 31.719 %, elapse: 2295.925 sec
- (Validation) ppl:  72.15711, accuracy: 34.614 %, elapse: 86.153 sec
model saved in Epoch 5
- (Training)   ppl:  56.40355, accuracy: 38.046 %, elapse: 2309.805 sec
- (Validation) ppl:  44.49319, accuracy: 40.561 %, elapse: 86.860 sec
model saved in Epoch 6
- (Training)   ppl:  36.61689, accuracy: 43.124 %, elapse: 2311.882 sec
- (Validation) ppl:  28.53583, accuracy: 45.696 %, elapse: 86.920 sec
model saved in Epoch 7
- (Training)   ppl:  25.73121, accuracy: 47.185 %, elapse: 2310.277 sec
- (Validation) ppl:  20.98016, accuracy: 49.976 %, elapse: 86.398 sec
model saved in Epoch 8
- (Training)   ppl:  19.48360, accuracy: 50.477 %, elapse: 2324.461 sec
- (Validation) ppl:  15.58509, accuracy: 53.410 %, elapse: 86.632 sec
model saved in Epoch 9
- (Training)   ppl:  15.78136, accuracy: 52.940 %, elapse: 2302.925 sec
- (Validation) ppl:  12.80189, accuracy: 55.606 %, elapse: 85.949 sec
model saved in Epoch 10
- (Training)   ppl:  13.44409, accuracy: 54.704 %, elapse: 2305.115 sec
- (Validation) ppl:  11.31573, accuracy: 57.151 %, elapse: 86.332 sec
model saved in Epoch 11
- (Training)   ppl:  11.90822, accuracy: 55.968 %, elapse: 2313.271 sec
- (Validation) ppl:  9.92727, accuracy: 58.570 %, elapse: 87.054 sec
model saved in Epoch 12
- (Training)   ppl:  10.64744, accuracy: 57.207 %, elapse: 2309.748 sec
- (Validation) ppl:  9.00181, accuracy: 59.855 %, elapse: 86.670 sec
model saved in Epoch 13
- (Training)   ppl:  9.54828, accuracy: 58.568 %, elapse: 2312.453 sec
- (Validation) ppl:  7.84871, accuracy: 61.661 %, elapse: 86.230 sec
model saved in Epoch 14
- (Training)   ppl:  8.70708, accuracy: 59.701 %, elapse: 2298.159 sec
- (Validation) ppl:  7.47162, accuracy: 62.289 %, elapse: 86.338 sec
model saved in Epoch 15
- (Training)   ppl:  8.04220, accuracy: 60.681 %, elapse: 2302.425 sec
- (Validation) ppl:  7.02669, accuracy: 63.179 %, elapse: 86.415 sec
model saved in Epoch 16
- (Training)   ppl:  7.51386, accuracy: 61.524 %, elapse: 2301.235 sec
- (Validation) ppl:  6.56633, accuracy: 64.222 %, elapse: 86.229 sec
model saved in Epoch 17
- (Training)   ppl:  7.04961, accuracy: 62.405 %, elapse: 2315.960 sec
- (Validation) ppl:  6.08169, accuracy: 65.101 %, elapse: 87.039 sec
model saved in Epoch 18
- (Training)   ppl:  6.67793, accuracy: 63.112 %, elapse: 2317.159 sec
- (Validation) ppl:  6.03157, accuracy: 65.375 %, elapse: 87.003 sec
model saved in Epoch 19
- (Training)   ppl:  6.35582, accuracy: 63.766 %, elapse: 2301.429 sec
- (Validation) ppl:  5.58260, accuracy: 66.169 %, elapse: 86.303 sec
model saved in Epoch 20
- (Training)   ppl:  6.07604, accuracy: 64.377 %, elapse: 2313.734 sec
- (Validation) ppl:  5.41451, accuracy: 66.746 %, elapse: 86.200 sec
model saved in Epoch 21
- (Training)   ppl:  5.81621, accuracy: 64.977 %, elapse: 2319.373 sec
- (Validation) ppl:  5.40037, accuracy: 66.694 %, elapse: 87.050 sec
model saved in Epoch 22
- (Training)   ppl:  5.60028, accuracy: 65.488 %, elapse: 2316.583 sec
- (Validation) ppl:  5.03672, accuracy: 67.928 %, elapse: 86.795 sec
model saved in Epoch 23
- (Training)   ppl:  5.40050, accuracy: 65.997 %, elapse: 2328.172 sec
- (Validation) ppl:  4.86980, accuracy: 68.357 %, elapse: 87.577 sec
model saved in Epoch 24
- (Training)   ppl:  5.22113, accuracy: 66.479 %, elapse: 2312.762 sec
- (Validation) ppl:  4.85312, accuracy: 68.271 %, elapse: 87.425 sec
model saved in Epoch 25
- (Training)   ppl:  5.07840, accuracy: 66.909 %, elapse: 2318.574 sec
- (Validation) ppl:  4.72617, accuracy: 68.719 %, elapse: 87.089 sec
model saved in Epoch 26
- (Training)   ppl:  4.92162, accuracy: 67.284 %, elapse: 2313.637 sec
- (Validation) ppl:  4.55458, accuracy: 69.302 %, elapse: 86.729 sec
model saved in Epoch 27
- (Training)   ppl:  4.79420, accuracy: 67.684 %, elapse: 2323.144 sec
- (Validation) ppl:  4.48063, accuracy: 69.564 %, elapse: 86.737 sec
model saved in Epoch 28
- (Training)   ppl:  4.68634, accuracy: 68.012 %, elapse: 2317.577 sec
- (Validation) ppl:  4.35901, accuracy: 69.809 %, elapse: 87.136 sec
model saved in Epoch 29
- (Training)   ppl:  4.56964, accuracy: 68.420 %, elapse: 2314.454 sec
- (Validation) ppl:  4.30586, accuracy: 70.197 %, elapse: 87.504 sec
model saved in Epoch 30
- (Training)   ppl:  4.46348, accuracy: 68.746 %, elapse: 2321.432 sec
- (Validation) ppl:  4.23415, accuracy: 70.369 %, elapse: 86.935 sec
model saved in Epoch 31
- (Training)   ppl:  4.36785, accuracy: 69.062 %, elapse: 2320.504 sec
- (Validation) ppl:  4.11285, accuracy: 70.879 %, elapse: 87.000 sec
model saved in Epoch 32
- (Training)   ppl:  4.27625, accuracy: 69.375 %, elapse: 2318.761 sec
- (Validation) ppl:  4.17381, accuracy: 70.598 %, elapse: 87.044 sec
- (Training)   ppl:  4.19137, accuracy: 69.658 %, elapse: 2316.053 sec
- (Validation) ppl:  3.98683, accuracy: 71.310 %, elapse: 86.876 sec
model saved in Epoch 34
- (Training)   ppl:  4.11511, accuracy: 69.958 %, elapse: 2315.036 sec
- (Validation) ppl:  4.01590, accuracy: 71.273 %, elapse: 87.061 sec
- (Training)   ppl:  4.03788, accuracy: 70.257 %, elapse: 2311.023 sec
- (Validation) ppl:  3.96333, accuracy: 71.473 %, elapse: 86.679 sec
model saved in Epoch 36
- (Training)   ppl:  3.97014, accuracy: 70.475 %, elapse: 2322.491 sec
- (Validation) ppl:  3.93349, accuracy: 71.417 %, elapse: 86.664 sec
model saved in Epoch 37
- (Training)   ppl:  3.90813, accuracy: 70.734 %, elapse: 2322.689 sec
- (Validation) ppl:  3.78311, accuracy: 72.224 %, elapse: 87.393 sec
model saved in Epoch 38
- (Training)   ppl:  3.84701, accuracy: 70.963 %, elapse: 2313.157 sec
- (Validation) ppl:  3.74372, accuracy: 72.267 %, elapse: 86.688 sec
model saved in Epoch 39
- (Training)   ppl:  3.79470, accuracy: 71.163 %, elapse: 2312.692 sec
- (Validation) ppl:  3.67105, accuracy: 72.633 %, elapse: 86.960 sec
model saved in Epoch 40
- (Training)   ppl:  3.73578, accuracy: 71.407 %, elapse: 2321.613 sec
- (Validation) ppl:  3.65853, accuracy: 72.661 %, elapse: 86.740 sec
model saved in Epoch 41
- (Training)   ppl:  3.68202, accuracy: 71.639 %, elapse: 2315.191 sec
- (Validation) ppl:  3.60525, accuracy: 73.041 %, elapse: 86.950 sec
model saved in Epoch 42
- (Training)   ppl:  3.64036, accuracy: 71.796 %, elapse: 2316.262 sec
- (Validation) ppl:  3.59202, accuracy: 73.021 %, elapse: 86.969 sec
model saved in Epoch 43
- (Training)   ppl:  3.58698, accuracy: 72.020 %, elapse: 2312.447 sec
- (Validation) ppl:  3.53268, accuracy: 73.335 %, elapse: 86.973 sec
model saved in Epoch 44
- (Training)   ppl:  3.54103, accuracy: 72.220 %, elapse: 2307.402 sec
- (Validation) ppl:  3.59473, accuracy: 73.079 %, elapse: 87.019 sec
- (Training)   ppl:  3.50195, accuracy: 72.394 %, elapse: 2312.481 sec
- (Validation) ppl:  3.49418, accuracy: 73.502 %, elapse: 86.907 sec
model saved in Epoch 46
- (Training)   ppl:  3.46087, accuracy: 72.602 %, elapse: 2309.727 sec
- (Validation) ppl:  3.51172, accuracy: 73.519 %, elapse: 86.724 sec
- (Training)   ppl:  3.42005, accuracy: 72.772 %, elapse: 2320.183 sec
- (Validation) ppl:  3.48164, accuracy: 73.378 %, elapse: 87.371 sec
model saved in Epoch 48
- (Training)   ppl:  3.37656, accuracy: 72.991 %, elapse: 2323.895 sec
- (Validation) ppl:  3.36221, accuracy: 74.235 %, elapse: 87.360 sec
model saved in Epoch 49
- (Training)   ppl:  3.34696, accuracy: 73.071 %, elapse: 2321.281 sec
- (Validation) ppl:  3.38008, accuracy: 73.920 %, elapse: 86.561 sec
