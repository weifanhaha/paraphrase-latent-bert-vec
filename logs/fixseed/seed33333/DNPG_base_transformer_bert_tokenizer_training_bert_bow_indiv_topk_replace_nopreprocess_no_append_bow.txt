Config: {'save_model_path': '../models/DNPG_base_transformer_bert_tokenizer_bert_bow_indivtopk_replace_nopreprocess_no_append_bow.pth', 'log_file': '../logs/DNPG_base_transformer_bert_tokenizer_training_bert_bow_indiv_topk_replace_nopreprocess_no_append_bow.txt', 'test_output_file': '../outputs/test_DNPG_transformer_bert_tokenizer_bow_indivtopk_replace_out_nopreprocess_no_append_bow.txt', 'val_output_file': '../outputs/val_DNPG_transformer_bert_tokenizer_bow_indivtopk_replace_out_nopreprocess_no_append_bow.txt', 'dataset': 'quora_bert_mask_predict_dataset', 'num_epochs': 50, 'batch_size': 100, 'd_model': 450, 'd_inner_hid': 512, 'd_k': 50, 'd_v': 50, 'n_head': 9, 'n_layers': 3, 'n_warmup_steps': 12000, 'dropout': 0.1, 'embs_share_weight': True, 'proj_share_weight': True, 'label_smoothing': False, 'train_size': 100000, 'val_size': 4000, 'test_size': 20000, 'is_bow': True, 'bow_strategy': 'indiv_topk', 'indiv_topk': 10, 'topk': 25, 'lr': '1e-3', 'only_bow': False, 'replace_predict': True, 'append_bow': False}
- (Training)   ppl:  20139.14435, accuracy: 7.819 %, elapse: 4633.360 sec
- (Validation) ppl:  9800.89111, accuracy: 8.568 %, elapse: 122.892 sec
model saved in Epoch 1
- (Training)   ppl:  2749.56729, accuracy: 11.926 %, elapse: 4606.267 sec
- (Validation) ppl:  777.55484, accuracy: 14.996 %, elapse: 126.894 sec
model saved in Epoch 2
- (Training)   ppl:  438.58855, accuracy: 16.172 %, elapse: 4590.069 sec
- (Validation) ppl:  256.34733, accuracy: 21.844 %, elapse: 126.569 sec
model saved in Epoch 3
- (Training)   ppl:  181.51891, accuracy: 24.792 %, elapse: 4596.838 sec
- (Validation) ppl:  143.31011, accuracy: 27.397 %, elapse: 127.341 sec
model saved in Epoch 4
- (Training)   ppl:  102.90271, accuracy: 30.750 %, elapse: 4584.741 sec
- (Validation) ppl:  85.52596, accuracy: 31.858 %, elapse: 129.571 sec
model saved in Epoch 5
- (Training)   ppl:  65.09083, accuracy: 35.827 %, elapse: 4604.374 sec
- (Validation) ppl:  52.52937, accuracy: 38.341 %, elapse: 128.427 sec
model saved in Epoch 6
- (Training)   ppl:  45.84075, accuracy: 39.817 %, elapse: 4608.802 sec
- (Validation) ppl:  37.34408, accuracy: 42.060 %, elapse: 129.771 sec
model saved in Epoch 7
- (Training)   ppl:  35.06834, accuracy: 42.598 %, elapse: 4585.397 sec
- (Validation) ppl:  29.85806, accuracy: 44.181 %, elapse: 126.337 sec
model saved in Epoch 8
- (Training)   ppl:  28.32164, accuracy: 44.680 %, elapse: 4584.718 sec
- (Validation) ppl:  23.77576, accuracy: 46.553 %, elapse: 130.282 sec
model saved in Epoch 9
- (Training)   ppl:  23.89138, accuracy: 46.342 %, elapse: 4580.985 sec
- (Validation) ppl:  19.49497, accuracy: 48.771 %, elapse: 131.859 sec
model saved in Epoch 10
- (Training)   ppl:  20.82831, accuracy: 47.589 %, elapse: 4585.562 sec
- (Validation) ppl:  17.26755, accuracy: 49.741 %, elapse: 128.361 sec
model saved in Epoch 11
- (Training)   ppl:  18.60924, accuracy: 48.643 %, elapse: 4599.445 sec
- (Validation) ppl:  16.42390, accuracy: 49.734 %, elapse: 129.303 sec
model saved in Epoch 12
- (Training)   ppl:  16.77546, accuracy: 49.653 %, elapse: 4601.223 sec
- (Validation) ppl:  14.18140, accuracy: 51.632 %, elapse: 130.435 sec
model saved in Epoch 13
- (Training)   ppl:  15.10152, accuracy: 50.852 %, elapse: 4602.046 sec
- (Validation) ppl:  13.03690, accuracy: 52.705 %, elapse: 128.183 sec
model saved in Epoch 14
- (Training)   ppl:  13.80860, accuracy: 51.815 %, elapse: 4615.384 sec
- (Validation) ppl:  12.11698, accuracy: 53.494 %, elapse: 130.938 sec
model saved in Epoch 15
- (Training)   ppl:  12.71342, accuracy: 52.847 %, elapse: 4708.625 sec
- (Validation) ppl:  11.21365, accuracy: 55.102 %, elapse: 129.435 sec
model saved in Epoch 16
- (Training)   ppl:  11.83824, accuracy: 53.724 %, elapse: 4660.536 sec
- (Validation) ppl:  10.25212, accuracy: 56.147 %, elapse: 127.120 sec
model saved in Epoch 17
- (Training)   ppl:  11.08636, accuracy: 54.523 %, elapse: 4615.489 sec
- (Validation) ppl:  9.29756, accuracy: 57.670 %, elapse: 132.573 sec
model saved in Epoch 18
- (Training)   ppl:  10.48981, accuracy: 55.243 %, elapse: 4618.054 sec
- (Validation) ppl:  9.14925, accuracy: 57.790 %, elapse: 130.358 sec
model saved in Epoch 19
- (Training)   ppl:  9.94216, accuracy: 55.949 %, elapse: 4639.396 sec
- (Validation) ppl:  8.67623, accuracy: 58.448 %, elapse: 127.762 sec
model saved in Epoch 20
- (Training)   ppl:  9.46833, accuracy: 56.534 %, elapse: 4634.815 sec
- (Validation) ppl:  8.27201, accuracy: 59.207 %, elapse: 131.760 sec
model saved in Epoch 21
- (Training)   ppl:  9.05557, accuracy: 57.111 %, elapse: 4707.235 sec
- (Validation) ppl:  8.09581, accuracy: 59.488 %, elapse: 130.981 sec
model saved in Epoch 22
- (Training)   ppl:  8.70915, accuracy: 57.589 %, elapse: 4446.474 sec
- (Validation) ppl:  7.76827, accuracy: 60.007 %, elapse: 110.984 sec
model saved in Epoch 23
- (Training)   ppl:  8.36522, accuracy: 58.105 %, elapse: 4024.864 sec
- (Validation) ppl:  7.35647, accuracy: 60.822 %, elapse: 108.635 sec
model saved in Epoch 24
- (Training)   ppl:  8.09383, accuracy: 58.541 %, elapse: 4047.031 sec
- (Validation) ppl:  7.28210, accuracy: 60.829 %, elapse: 114.072 sec
model saved in Epoch 25
- (Training)   ppl:  7.81255, accuracy: 59.027 %, elapse: 4029.616 sec
- (Validation) ppl:  7.08954, accuracy: 61.416 %, elapse: 112.154 sec
model saved in Epoch 26
- (Training)   ppl:  7.55680, accuracy: 59.462 %, elapse: 4058.950 sec
- (Validation) ppl:  6.83391, accuracy: 61.916 %, elapse: 108.582 sec
model saved in Epoch 27
- (Training)   ppl:  7.33077, accuracy: 59.874 %, elapse: 3999.168 sec
- (Validation) ppl:  6.54576, accuracy: 62.862 %, elapse: 104.289 sec
model saved in Epoch 28
- (Training)   ppl:  7.13783, accuracy: 60.262 %, elapse: 4036.547 sec
- (Validation) ppl:  6.56302, accuracy: 62.560 %, elapse: 111.357 sec
- (Training)   ppl:  6.94455, accuracy: 60.583 %, elapse: 4024.849 sec
- (Validation) ppl:  6.38513, accuracy: 62.943 %, elapse: 115.225 sec
model saved in Epoch 30
- (Training)   ppl:  6.79194, accuracy: 60.894 %, elapse: 4023.727 sec
- (Validation) ppl:  6.20990, accuracy: 63.508 %, elapse: 108.531 sec
model saved in Epoch 31
- (Training)   ppl:  6.60885, accuracy: 61.295 %, elapse: 4026.832 sec
- (Validation) ppl:  6.13851, accuracy: 63.675 %, elapse: 109.369 sec
model saved in Epoch 32
- (Training)   ppl:  6.45793, accuracy: 61.601 %, elapse: 4036.745 sec
- (Validation) ppl:  5.91780, accuracy: 64.177 %, elapse: 116.039 sec
model saved in Epoch 33
- (Training)   ppl:  6.32175, accuracy: 61.895 %, elapse: 4624.625 sec
- (Validation) ppl:  5.84376, accuracy: 64.374 %, elapse: 131.860 sec
model saved in Epoch 34
- (Training)   ppl:  6.18839, accuracy: 62.202 %, elapse: 4627.663 sec
- (Validation) ppl:  5.70801, accuracy: 64.899 %, elapse: 127.009 sec
model saved in Epoch 35
- (Training)   ppl:  6.05595, accuracy: 62.459 %, elapse: 4707.239 sec
- (Validation) ppl:  5.70865, accuracy: 64.760 %, elapse: 132.057 sec
- (Training)   ppl:  5.94074, accuracy: 62.760 %, elapse: 4640.199 sec
- (Validation) ppl:  5.57831, accuracy: 65.247 %, elapse: 130.147 sec
model saved in Epoch 37
- (Training)   ppl:  5.83734, accuracy: 63.011 %, elapse: 4638.060 sec
- (Validation) ppl:  5.44113, accuracy: 65.657 %, elapse: 131.630 sec
model saved in Epoch 38
- (Training)   ppl:  5.73408, accuracy: 63.239 %, elapse: 4654.809 sec
- (Validation) ppl:  5.43132, accuracy: 65.678 %, elapse: 131.406 sec
model saved in Epoch 39
- (Training)   ppl:  5.63366, accuracy: 63.495 %, elapse: 4633.219 sec
- (Validation) ppl:  5.33026, accuracy: 66.083 %, elapse: 136.873 sec
model saved in Epoch 40
- (Training)   ppl:  5.54584, accuracy: 63.713 %, elapse: 4643.479 sec
- (Validation) ppl:  5.25689, accuracy: 66.193 %, elapse: 132.411 sec
model saved in Epoch 41
- (Training)   ppl:  5.45875, accuracy: 63.950 %, elapse: 4657.041 sec
- (Validation) ppl:  5.15580, accuracy: 66.560 %, elapse: 132.245 sec
model saved in Epoch 42
- (Training)   ppl:  5.36300, accuracy: 64.224 %, elapse: 4650.655 sec
- (Validation) ppl:  5.03562, accuracy: 66.935 %, elapse: 133.812 sec
model saved in Epoch 43
- (Training)   ppl:  5.28616, accuracy: 64.431 %, elapse: 4067.696 sec
- (Validation) ppl:  5.02167, accuracy: 66.879 %, elapse: 111.585 sec
model saved in Epoch 44
- (Training)   ppl:  5.20656, accuracy: 64.637 %, elapse: 4030.771 sec
- (Validation) ppl:  4.98857, accuracy: 67.048 %, elapse: 108.032 sec
model saved in Epoch 45
- (Training)   ppl:  5.13271, accuracy: 64.805 %, elapse: 4024.335 sec
- (Validation) ppl:  4.96605, accuracy: 67.119 %, elapse: 113.239 sec
model saved in Epoch 46
- (Training)   ppl:  5.06889, accuracy: 64.980 %, elapse: 4030.030 sec
- (Validation) ppl:  4.94564, accuracy: 67.173 %, elapse: 106.334 sec
model saved in Epoch 47
- (Training)   ppl:  4.99592, accuracy: 65.195 %, elapse: 4029.956 sec
- (Validation) ppl:  4.86220, accuracy: 67.529 %, elapse: 109.386 sec
model saved in Epoch 48
- (Training)   ppl:  4.93273, accuracy: 65.380 %, elapse: 4007.750 sec
- (Validation) ppl:  4.75427, accuracy: 67.983 %, elapse: 105.677 sec
model saved in Epoch 49
- (Training)   ppl:  4.87037, accuracy: 65.545 %, elapse: 4014.924 sec
- (Validation) ppl:  4.76175, accuracy: 67.878 %, elapse: 103.969 sec
