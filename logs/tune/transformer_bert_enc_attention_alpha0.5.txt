Config: {'save_model_path': '../models/transformer_bert_enc_attention.pth', 'log_file': '../logs/transformer_bert_enc_attention.txt', 'test_output_file': '../outputs/test_transformer_bert_enc_attention.txt', 'val_output_file': '../outputs/val_transformer_bert_enc_attention.txt', 'preprocessed_folder': '../data/preprocess_quora_bert_mask_predict/', 'dataset': 'quora_bert_dataset', 'num_epochs': 50, 'batch_size': 100, 'd_model': 450, 'd_inner_hid': 512, 'd_k': 50, 'd_v': 50, 'n_head': 9, 'n_layers': 3, 'n_warmup_steps': 12000, 'dropout': 0.1, 'embs_share_weight': True, 'proj_share_weight': True, 'label_smoothing': False, 'train_size': 100000, 'val_size': 4000, 'test_size': 20000, 'is_bow': False, 'lr': '1e-3'}
- (Training)   ppl:  20126.16128, accuracy: 7.511 %, elapse: 4634.926 sec
- (Validation) ppl:  9773.71142, accuracy: 7.821 %, elapse: 98.172 sec
model saved in Epoch 1
- (Training)   ppl:  2751.81079, accuracy: 7.834 %, elapse: 4357.391 sec
- (Validation) ppl:  767.40336, accuracy: 7.821 %, elapse: 95.708 sec
model saved in Epoch 2
- (Training)   ppl:  441.14642, accuracy: 13.489 %, elapse: 4330.169 sec
- (Validation) ppl:  247.61603, accuracy: 21.945 %, elapse: 94.826 sec
model saved in Epoch 3
- (Training)   ppl:  185.12048, accuracy: 24.275 %, elapse: 4334.712 sec
- (Validation) ppl:  136.01012, accuracy: 27.386 %, elapse: 97.093 sec
model saved in Epoch 4
- (Training)   ppl:  112.55969, accuracy: 29.690 %, elapse: 4291.573 sec
- (Validation) ppl:  83.09504, accuracy: 32.780 %, elapse: 98.309 sec
model saved in Epoch 5
- (Training)   ppl:  76.28346, accuracy: 33.334 %, elapse: 4276.751 sec
- (Validation) ppl:  64.32047, accuracy: 35.394 %, elapse: 96.455 sec
model saved in Epoch 6
- (Training)   ppl:  62.02262, accuracy: 35.109 %, elapse: 4293.785 sec
- (Validation) ppl:  52.91555, accuracy: 36.734 %, elapse: 97.588 sec
model saved in Epoch 7
- (Training)   ppl:  54.58983, accuracy: 36.026 %, elapse: 4281.350 sec
- (Validation) ppl:  43.54536, accuracy: 38.793 %, elapse: 95.627 sec
model saved in Epoch 8
- (Training)   ppl:  52.43347, accuracy: 35.907 %, elapse: 4274.016 sec
- (Validation) ppl:  48.26006, accuracy: 36.483 %, elapse: 97.378 sec
- (Training)   ppl:  56.40176, accuracy: 34.328 %, elapse: 4287.554 sec
- (Validation) ppl:  57.82278, accuracy: 33.987 %, elapse: 96.470 sec
- (Training)   ppl:  54.21839, accuracy: 34.477 %, elapse: 4262.044 sec
- (Validation) ppl:  53.07625, accuracy: 34.968 %, elapse: 95.808 sec
- (Training)   ppl:  47.87599, accuracy: 35.539 %, elapse: 4245.246 sec
- (Validation) ppl:  50.60067, accuracy: 34.988 %, elapse: 96.485 sec
- (Training)   ppl:  46.93897, accuracy: 35.419 %, elapse: 4235.613 sec
- (Validation) ppl:  42.35969, accuracy: 36.596 %, elapse: 95.865 sec
model saved in Epoch 13
- (Training)   ppl:  39.96899, accuracy: 37.424 %, elapse: 4211.014 sec
- (Validation) ppl:  30.79246, accuracy: 41.391 %, elapse: 95.883 sec
model saved in Epoch 14
- (Training)   ppl:  34.85453, accuracy: 39.053 %, elapse: 4206.944 sec
- (Validation) ppl:  27.83923, accuracy: 42.653 %, elapse: 96.426 sec
model saved in Epoch 15
- (Training)   ppl:  31.51168, accuracy: 40.355 %, elapse: 4223.948 sec
- (Validation) ppl:  27.87609, accuracy: 42.655 %, elapse: 97.070 sec
- (Training)   ppl:  28.96304, accuracy: 41.370 %, elapse: 4279.936 sec
- (Validation) ppl:  27.08946, accuracy: 42.437 %, elapse: 96.482 sec
model saved in Epoch 17
- (Training)   ppl:  27.67930, accuracy: 41.830 %, elapse: 4283.133 sec
- (Validation) ppl:  23.32550, accuracy: 44.856 %, elapse: 96.635 sec
model saved in Epoch 18
- (Training)   ppl:  26.04184, accuracy: 42.441 %, elapse: 4258.406 sec
- (Validation) ppl:  34.15426, accuracy: 39.694 %, elapse: 96.385 sec
- (Training)   ppl:  27.44558, accuracy: 41.605 %, elapse: 4308.811 sec
- (Validation) ppl:  24.11319, accuracy: 44.194 %, elapse: 99.098 sec
- (Training)   ppl:  24.71060, accuracy: 42.931 %, elapse: 4539.753 sec
- (Validation) ppl:  22.91342, accuracy: 44.822 %, elapse: 99.407 sec
model saved in Epoch 21
- (Training)   ppl:  24.13890, accuracy: 43.195 %, elapse: 4470.931 sec
- (Validation) ppl:  20.74075, accuracy: 46.303 %, elapse: 98.140 sec
model saved in Epoch 22
- (Training)   ppl:  22.94664, accuracy: 43.774 %, elapse: 4263.348 sec
- (Validation) ppl:  20.45083, accuracy: 46.444 %, elapse: 96.346 sec
model saved in Epoch 23
- (Training)   ppl:  22.14416, accuracy: 43.990 %, elapse: 4257.469 sec
- (Validation) ppl:  19.62360, accuracy: 46.837 %, elapse: 96.623 sec
model saved in Epoch 24
- (Training)   ppl:  22.07172, accuracy: 43.997 %, elapse: 4271.693 sec
- (Validation) ppl:  20.30955, accuracy: 46.392 %, elapse: 98.804 sec
- (Training)   ppl:  20.66276, accuracy: 44.961 %, elapse: 4255.114 sec
- (Validation) ppl:  18.64679, accuracy: 47.591 %, elapse: 99.792 sec
model saved in Epoch 26
- (Training)   ppl:  19.79674, accuracy: 45.483 %, elapse: 4259.242 sec
- (Validation) ppl:  18.08345, accuracy: 47.903 %, elapse: 96.855 sec
model saved in Epoch 27
- (Training)   ppl:  19.29515, accuracy: 45.760 %, elapse: 4254.984 sec
- (Validation) ppl:  17.76587, accuracy: 48.347 %, elapse: 97.256 sec
model saved in Epoch 28
- (Training)   ppl:  19.69381, accuracy: 45.364 %, elapse: 4270.809 sec
- (Validation) ppl:  17.69284, accuracy: 48.188 %, elapse: 95.919 sec
model saved in Epoch 29
- (Training)   ppl:  18.75324, accuracy: 46.018 %, elapse: 4246.146 sec
- (Validation) ppl:  17.12918, accuracy: 48.668 %, elapse: 97.089 sec
model saved in Epoch 30
- (Training)   ppl:  18.45708, accuracy: 46.230 %, elapse: 4236.023 sec
- (Validation) ppl:  18.44389, accuracy: 47.450 %, elapse: 96.857 sec
- (Training)   ppl:  18.38442, accuracy: 46.176 %, elapse: 4239.489 sec
- (Validation) ppl:  17.10548, accuracy: 48.706 %, elapse: 96.468 sec
model saved in Epoch 32
- (Training)   ppl:  17.85827, accuracy: 46.530 %, elapse: 4238.935 sec
- (Validation) ppl:  17.07048, accuracy: 48.763 %, elapse: 96.276 sec
model saved in Epoch 33
- (Training)   ppl:  17.77334, accuracy: 46.583 %, elapse: 4232.926 sec
- (Validation) ppl:  17.07727, accuracy: 48.848 %, elapse: 96.630 sec
- (Training)   ppl:  17.20898, accuracy: 46.987 %, elapse: 4235.272 sec
- (Validation) ppl:  16.74994, accuracy: 49.116 %, elapse: 96.778 sec
model saved in Epoch 35
- (Training)   ppl:  16.76909, accuracy: 47.288 %, elapse: 4240.432 sec
- (Validation) ppl:  16.27582, accuracy: 49.482 %, elapse: 99.271 sec
model saved in Epoch 36
- (Training)   ppl:  17.03743, accuracy: 47.062 %, elapse: 4250.673 sec
- (Validation) ppl:  16.24951, accuracy: 49.505 %, elapse: 96.724 sec
model saved in Epoch 37
- (Training)   ppl:  16.58631, accuracy: 47.394 %, elapse: 4257.220 sec
- (Validation) ppl:  16.57357, accuracy: 49.171 %, elapse: 96.884 sec
- (Training)   ppl:  16.10933, accuracy: 47.813 %, elapse: 4246.926 sec
- (Validation) ppl:  16.37828, accuracy: 49.407 %, elapse: 95.450 sec
- (Training)   ppl:  16.42247, accuracy: 47.500 %, elapse: 4297.791 sec
- (Validation) ppl:  15.33739, accuracy: 50.300 %, elapse: 97.521 sec
model saved in Epoch 40
- (Training)   ppl:  15.71379, accuracy: 48.017 %, elapse: 4511.162 sec
- (Validation) ppl:  15.74907, accuracy: 49.943 %, elapse: 99.988 sec
- (Training)   ppl:  15.88016, accuracy: 47.861 %, elapse: 4526.109 sec
- (Validation) ppl:  15.90675, accuracy: 49.717 %, elapse: 97.049 sec
- (Training)   ppl:  15.94393, accuracy: 47.794 %, elapse: 4365.956 sec
- (Validation) ppl:  15.14725, accuracy: 50.514 %, elapse: 98.305 sec
model saved in Epoch 43
- (Training)   ppl:  15.33717, accuracy: 48.324 %, elapse: 4246.402 sec
- (Validation) ppl:  15.20988, accuracy: 50.678 %, elapse: 96.271 sec
- (Training)   ppl:  15.08491, accuracy: 48.528 %, elapse: 4260.801 sec
- (Validation) ppl:  15.37604, accuracy: 50.319 %, elapse: 97.491 sec
- (Training)   ppl:  14.86616, accuracy: 48.699 %, elapse: 4249.543 sec
- (Validation) ppl:  15.78727, accuracy: 50.017 %, elapse: 98.159 sec
- (Training)   ppl:  14.81709, accuracy: 48.821 %, elapse: 4248.740 sec
- (Validation) ppl:  14.58246, accuracy: 51.298 %, elapse: 96.721 sec
model saved in Epoch 47
- (Training)   ppl:  14.38957, accuracy: 49.171 %, elapse: 4251.042 sec
- (Validation) ppl:  15.17622, accuracy: 50.359 %, elapse: 97.344 sec
- (Training)   ppl:  14.11185, accuracy: 49.421 %, elapse: 4343.100 sec
- (Validation) ppl:  14.08804, accuracy: 51.768 %, elapse: 96.740 sec
model saved in Epoch 49
- (Training)   ppl:  13.96491, accuracy: 49.541 %, elapse: 4270.729 sec
- (Validation) ppl:  13.90977, accuracy: 51.884 %, elapse: 97.061 sec
model saved in Epoch 50
